$(document).ready(function(){var a=[];if(document.getElementById("map")){var d={center:new google.maps.LatLng(45.423494,-75.697933),zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP};var f=new google.maps.Map(document.getElementById("map"),d);var c;$(".courts > li").each(function(l,j){var n=$(this).find("a").html();var h='<div class="info-window"><strong>'+n+'</strong><a href="courts/'+$(this).attr("data-id")+'">Rate or Comment!</a></div>';var o=parseFloat($(this).find('meta[itemprop="latitude"]').attr("content"));var q=parseFloat($(this).find('meta[itemprop="longitude"]').attr("content"));var p=new google.maps.LatLng(o,q);a.push({id:$(this).attr("data-id"),lat:o,lng:q});var m=new google.maps.Marker({position:p,map:f,title:n,icon:"images/ball.png",animation:google.maps.Animation.DROP});function k(i){if(i.preventDefault){i.preventDefault()}if(c){c.close()}c=new google.maps.InfoWindow({content:h});c.open(f,m)}google.maps.event.addListener(m,"click",k);google.maps.event.addDomListener($(this).get(0),"click",k)})}var g=$(".rater-usable li");g.on("mouseenter",function(j){var k=$(this).index();for(var h=0;h<k;h++){g.eq(h).addClass("is-rated-hover")}}).on("mouseleave",function(h){g.removeClass("is-rated-hover")});var b;function e(p,q){var s=[],h=a.length,r=new google.maps.LatLng(p,q);if(b){b.setPosition(r)}else{b=new google.maps.Marker({position:r,map:f,title:"You are here.",icon:"images/user.png",animation:google.maps.Animation.DROP})}f.setCenter(r);var n=new LatLon(p,q);for(var l=0;l<h;l++){s.push({id:a[l].id,distance:parseFloat(n.distanceTo(new LatLon(a[l].lat,a[l].lng)))})}s.sort(function(j,i){return j.distance-i.distance});var m=$(".courts");for(var k=0;k<h;k++){var o=m.find('[data-id="'+s[k].id+'"]');o.find(".distance").html(s[k].distance.toFixed(1)+" km");m.append(o)}}if(navigator.geolocation){$("#geo").click(function(){navigator.geolocation.getCurrentPosition(function(h){e(h.coords.latitude,h.coords.longitude)})})}$("#geo-form").on("submit",function(h){h.preventDefault();var i=new google.maps.Geocoder();i.geocode({address:$("#adr").val()+", Ottawa, ON",region:"CA"},function(k,j){if(j==google.maps.GeocoderStatus.OK){e(k[0].geometry.location.lat(),k[0].geometry.location.lng())}})})});